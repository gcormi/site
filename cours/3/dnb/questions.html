<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exercices : Systèmes Techniques</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* Variables pour les couleurs (permettant le mode sombre) */
    :root {
        --bg-color: #f4f4f9;
        --main-bg: white;
        --text-color: #333;
        --header-color: #0074d9;
        --title-color: #0074d9;
        --accent-color: #0074d9;
        --btn-color: #0074d9;
        --btn-hover: #005cbf;
        --border-color: #ccc;
        --input-bg: white;
        --feedback-color: #ff851b;
        --correct-color: #2ecc40;
        --incorrect-color: #ff4136;
        --section-bg: #f9f9f9;
        --table-header: #f9f9f9;
        --table-border: #ddd;
        --box-shadow: rgba(0, 0, 0, 0.1);
    }

    /* Mode sombre */
    .dark-theme {
        --bg-color: #1a1a2e;
        --main-bg: #16213e;
        --text-color: #e1e1e6;
        --header-color: #0f3460;
        --title-color: #4cc9f0;
        --accent-color: #4cc9f0;
        --btn-color: #4361ee;
        --btn-hover: #3f37c9;
        --border-color: #4cc9f0;
        --input-bg: #0f3460;
        --feedback-color: #ffb703;
        --correct-color: #52b788;
        --incorrect-color: #e63946;
        --section-bg: #0f3460;
        --table-header: #162447;
        --table-border: #3a506b;
        --box-shadow: rgba(0, 0, 0, 0.3);
    }

    /* Style CSS de base */
    body {
        font-family: 'Nunito', sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        line-height: 1.6;
        margin: 0;
        padding: 0;
        transition: all 0.3s ease;
    }

    header {
        background-color: var(--header-color);
        color: white;
        text-align: center;
        padding: 30px 0;
        position: relative;
        box-shadow: 0 4px 6px var(--box-shadow);
    }

    h1 {
        font-size: 2.2em;
        margin: 0;
        animation: fadeInDown 0.8s ease;
    }

    /* Bouton de changement de thème */
    .theme-toggle {
        position: absolute;
        top: 15px;
        right: 15px;
        background: transparent;
        border: none;
        color: white;
        font-size: 24px;
        cursor: pointer;
        transition: transform 0.3s ease;
    }

    .theme-toggle:hover {
        transform: rotate(30deg);
    }

    main {
        max-width: 1200px;
        margin: 30px auto;
        padding: 0 20px;
        animation: fadeIn 1s ease;
    }

    section {
        background-color: var(--main-bg);
        margin-bottom: 40px;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 4px 15px var(--box-shadow);
        transition: transform 0.3s ease;
    }

    section:hover {
        transform: translateY(-5px);
    }

    h2 {
        color: var(--title-color);
        border-bottom: 2px solid var(--border-color);
        padding-bottom: 10px;
        margin-top: 0;
        font-size: 1.8em;
        display: flex;
        align-items: center;
    }

    h2 i {
        margin-right: 10px;
    }

    h3 {
        color: var(--title-color);
        margin-top: 25px;
        font-size: 1.5em;
    }

    p {
        margin: 15px 0;
    }

    ul, ol {
        padding-left: 25px;
    }

    li {
        margin-bottom: 10px;
    }

    .question-container {
        background-color: var(--section-bg);
        padding: 20px;
        margin: 20px 0;
        border-radius: 8px;
        border-left: 4px solid var(--accent-color);
        transition: all 0.3s ease;
    }

    .question-container:hover {
        box-shadow: 0 6px 12px var(--box-shadow);
    }

    label {
        font-weight: bold;
        color: var(--title-color);
        display: block;
        margin-bottom: 10px;
    }

    textarea {
        width: 100%;
        height: 80px;
        margin-top: 10px;
        padding: 12px;
        border: 1px solid var(--border-color);
        border-radius: 5px;
        font-size: 1em;
        background-color: var(--input-bg);
        color: var(--text-color);
        resize: vertical;
        transition: border 0.3s ease;
    }

    textarea:focus {
        border-color: var(--accent-color);
        outline: none;
        box-shadow: 0 0 5px rgba(0, 116, 217, 0.3);
    }

    button {
        background-color: var(--btn-color);
        color: white;
        border: none;
        padding: 12px 18px;
        font-size: 1em;
        cursor: pointer;
        border-radius: 5px;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        margin-top: 10px;
    }

    button i {
        margin-right: 8px;
    }

    button:hover {
        background-color: var(--btn-hover);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px var(--box-shadow);
    }

    .btn-check {
        margin-top: 15px;
    }

    input[type="text"] {
        width: 100%;
        padding: 12px;
        margin-top: 10px;
        margin-bottom: 15px;
        border: 1px solid var(--border-color);
        border-radius: 5px;
        font-size: 1em;
        background-color: var(--input-bg);
        color: var(--text-color);
    }

    input[type="text"]:focus {
        border-color: var(--accent-color);
        outline: none;
    }

    .feedback {
        margin-top: 15px;
        padding: 10px;
        border-radius: 5px;
        font-weight: bold;
        display: none;
    }

    .feedback.correct {
        background-color: rgba(46, 204, 64, 0.1);
        color: var(--correct-color);
        border: 1px solid var(--correct-color);
    }

    .feedback.incorrect {
        background-color: rgba(255, 65, 54, 0.1);
        color: var(--incorrect-color);
        border: 1px solid var(--incorrect-color);
    }

    .system-card {
        background-color: var(--section-bg);
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        display: flex;
        flex-direction: column;
        border-left: 4px solid var(--accent-color);
    }

    .system-card h4 {
        color: var(--title-color);
        margin-top: 0;
    }

    .access-section {
        background-color: var(--section-bg);
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        margin-top: 30px;
    }

    .access-section h3 {
        margin-top: 0;
    }

    .answers-section {
        padding: 20px;
        border-radius: 8px;
        background-color: var(--section-bg);
        margin-top: 30px;
        display: none;
    }

    .answer-card {
        background-color: var(--main-bg);
        padding: 15px;
        border-radius: 8px;
        margin: 15px 0;
        box-shadow: 0 2px 6px var(--box-shadow);
    }

    .answer-card h4 {
        color: var(--title-color);
        margin-top: 0;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 8px;
    }

    /* Animation du score */
    .score-display {
        font-size: 1.3em;
        margin: 20px 0;
        animation: pulse 2s infinite;
        text-align: center;
    }

    .progress-bar {
        width: 100%;
        height: 20px;
        background-color: var(--section-bg);
        border-radius: 10px;
        margin: 20px 0;
        overflow: hidden;
    }

    .progress-fill {
        height: 100%;
        background-color: var(--accent-color);
        width: 0%;
        transition: width 1s ease;
        border-radius: 10px;
    }

    .summary {
        padding: 20px;
        background-color: var(--section-bg);
        border-radius: 8px;
        margin-top: 30px;
        text-align: center;
    }

    footer {
        background-color: var(--header-color);
        color: white;
        text-align: center;
        padding: 20px 0;
        margin-top: 50px;
    }

    .hidden {
        display: none;
    }

    /* Responsive design */
    @media (max-width: 768px) {
        header {
            padding: 20px 0;
        }
        
        h1 {
            font-size: 1.8em;
        }
        
        section {
            padding: 15px;
        }
        
        .theme-toggle {
            top: 10px;
            right: 10px;
        }
    }

    /* Animations */
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @keyframes fadeInDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
  </style>
</head>
<body>
  <header>
    <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </button>
    <h1><i class="fas fa-cogs"></i> Exercices : Systèmes Techniques</h1>
  </header>

  <main>
    <div class="summary">
      <h3><i class="fas fa-tasks"></i> Votre Progression</h3>
      <div class="progress-bar">
        <div class="progress-fill" id="progressBar"></div>
      </div>
      <p class="score-display">Score actuel: <span id="currentScore">0</span>/<span id="totalPossible">21</span> points</p>
    </div>

    <!-- Exercice 1 : Système de Sécurité Domestique -->
    <section id="exercice1">
      <h2><i class="fas fa-shield-alt"></i> Exercice 1 : Système de Sécurité Domestique Intelligent</h2>
      <p>
        Un système de sécurité domestique intelligent utilise des capteurs pour surveiller l'environnement et détecter des intrusions ou des anomalies. Il peut également envoyer des notifications en temps réel à l'utilisateur via une application mobile.
      </p>
      
      <div class="system-card">
        <h4><i class="fas fa-sitemap"></i> Composants du système</h4>
        <ul>
          <li><strong><i class="fas fa-sensor"></i> Capteurs :</strong> Les capteurs détectent les mouvements, les bruits suspects ou les variations de température.</li>
          <li><strong><i class="fas fa-microchip"></i> Traitement :</strong> Les données collectées par les capteurs sont analysées par un microprocesseur pour identifier des menaces potentielles.</li>
          <li><strong><i class="fas fa-bell"></i> Action :</strong> En cas d'anomalie, le système active une alarme sonore et envoie une notification à l'utilisateur.</li>
        </ul>
      </div>

      <h3><i class="fas fa-question-circle"></i> Questions</h3>
      <form id="exercise-1-form">
        <!-- Question 1 -->
        <div class="question-container">
          <label for="question1-1"><i class="fas fa-question"></i> Question 1 (2 points)</label>
          <p><strong>Quel est le rôle principal des capteurs dans ce système ?</strong></p>
          <textarea id="question1-1" placeholder="Entrez votre réponse ici..."></textarea>
          <div id="feedback1-1" class="feedback"></div>
          <button type="button" class="btn-check" onclick="checkAnswer('question1-1', 'feedback1-1', 'Le rôle principal des capteurs est de détecter des anomalies telles que des mouvements suspects ou des variations de température.', 2)">
            <i class="fas fa-check-circle"></i> Vérifier
          </button>
        </div>

        <!-- Question 2 -->
        <div class="question-container">
          <label for="question1-2"><i class="fas fa-question"></i> Question 2 (2 points)</label>
          <p><strong>Comment le microprocesseur contribue-t-il au bon fonctionnement du système ?</strong></p>
          <textarea id="question1-2" placeholder="Entrez votre réponse ici..."></textarea>
          <div id="feedback1-2" class="feedback"></div>
          <button type="button" class="btn-check" onclick="checkAnswer('question1-2', 'feedback1-2', 'Le microprocesseur analyse les données des capteurs pour identifier des menaces potentielles et décider des actions à prendre.', 2)">
            <i class="fas fa-check-circle"></i> Vérifier
          </button>
        </div>

        <!-- Question 3 -->
        <div class="question-container">
          <label for="question1-3"><i class="fas fa-question"></i> Question 3 (3 points)</label>
          <p><strong>Expliquez comment le système informe l'utilisateur en cas de détection d'une anomalie.</strong></p>
          <textarea id="question1-3" placeholder="Entrez vos réponses ici..."></textarea>
          <div id="feedback1-3" class="feedback"></div>
          <button type="button" class="btn-check" onclick="checkAnswer('question1-3', 'feedback1-3', 'En cas de détection d\'une anomalie, le système active une alarme sonore et envoie une notification à l\'utilisateur via une application mobile.', 3)">
            <i class="fas fa-check-circle"></i> Vérifier
          </button>
        </div>
      </form>
    </section>

    <!-- Exercice 2 : Système de Climatisation Autonome -->
    <section id="exercice2">
      <h2><i class="fas fa-temperature-low"></i> Exercice 2 : Système de Climatisation Autonome</h2>
      <p>
        Un système de climatisation autonome ajuste automatiquement la température ambiante en fonction des conditions extérieures et des préférences de l'utilisateur. Il utilise des capteurs, un microprocesseur et un compresseur pour réguler la température.
      </p>
      
      <div class="system-card">
        <h4><i class="fas fa-sitemap"></i> Composants du système</h4>
        <ul>
          <li><strong><i class="fas fa-thermometer-half"></i> Capteurs :</strong> Les capteurs mesurent la température intérieure et extérieure.</li>
          <li><strong><i class="fas fa-microchip"></i> Traitement :</strong> Le microprocesseur analyse les données pour décider si le compresseur doit être activé ou désactivé.</li>
          <li><strong><i class="fas fa-wind"></i> Action :</strong> Le compresseur refroidit ou chauffe l'air ambiant pour atteindre la température souhaitée.</li>
        </ul>
      </div>

      <h3><i class="fas fa-question-circle"></i> Questions</h3>
      <form id="exercise-2-form">
        <!-- Question 1 -->
        <div class="question-container">
          <label for="question2-1"><i class="fas fa-question"></i> Question 1 (2 points)</label>
          <p><strong>Quelle est la principale mission du système de climatisation autonome ?</strong></p>
          <textarea id="question2-1" placeholder="Entrez votre réponse ici..."></textarea>
          <div id="feedback2-1" class="feedback"></div>
          <button type="button" class="btn-check" onclick="checkAnswer('question2-1', 'feedback2-1', 'La principale mission du système de climatisation autonome est de réguler la température ambiante pour assurer le confort des occupants.', 2)">
            <i class="fas fa-check-circle"></i> Vérifier
          </button>
        </div>

        <!-- Question 2 -->
        <div class="question-container">
          <label for="question2-2"><i class="fas fa-question"></i> Question 2 (2 points)</label>
          <p><strong>Quels types de capteurs sont utilisés dans ce système et quelles informations fournissent-ils ?</strong></p>
          <textarea id="question2-2" placeholder="Entrez votre réponse ici..."></textarea>
          <div id="feedback2-2" class="feedback"></div>
          <button type="button" class="btn-check" onclick="checkAnswer('question2-2', 'feedback2-2', 'Les capteurs mesurent la température intérieure et extérieure pour fournir des données au microprocesseur.', 2)">
            <i class="fas fa-check-circle"></i> Vérifier
          </button>
        </div>

        <!-- Question 3 -->
        <div class="question-container">
          <label for="question2-3"><i class="fas fa-question"></i> Question 3 (3 points)</label>
          <p><strong>Décrivez le processus complet qui permet au système de réguler la température ambiante.</strong></p>
          <textarea id="question2-3" placeholder="Entrez vos réponses ici..."></textarea>
          <div id="feedback2-3" class="feedback"></div>
          <button type="button" class="btn-check" onclick="checkAnswer('question2-3', 'feedback2-3', 'Le microprocesseur analyse les données des capteurs et décide d\'activer ou non le compresseur pour refroidir ou chauffer l\'air ambiant jusqu\'à atteindre la température souhaitée.', 3)">
            <i class="fas fa-check-circle"></i> Vérifier
          </button>
        </div>
      </form>
    </section>

    <!-- Exercice 3 : Robot Aspirateur -->
    <section id="exercice3">
      <h2><i class="fas fa-robot"></i> Exercice 3 : Robot Aspirateur</h2>
      <p>
        Dans le cadre de la lutte contre la saleté et la poussière dans les maisons, les fabricants de robots aspirateurs ont développé des systèmes autonomes capables de nettoyer les sols de manière efficace et sans intervention humaine constante. Le robot aspirateur est conçu pour naviguer dans un environnement domestique tout en évitant les obstacles et optimisant son parcours.
      </p>
      
      <div class="system-card">
        <h4><i class="fas fa-sitemap"></i> Composants du système</h4>
        <ul>
          <li><strong><i class="fas fa-eye"></i> Capteurs :</strong> Les robots aspirateurs sont équipés de capteurs infrarouges, ultrasoniques ou laser pour détecter les obstacles (mobilier, câbles, escaliers).</li>
          <li><strong><i class="fas fa-map-marked-alt"></i> Navigation :</strong> Les robots utilisent des algorithmes de navigation pour explorer la pièce de manière systématique.</li>
          <li><strong><i class="fas fa-vacuum-cleaner"></i> Nettoyage :</strong> Le robot aspire la poussière et les débris grâce à un moteur puissant.</li>
        </ul>
      </div>

      <h3><i class="fas fa-question-circle"></i> Questions</h3>
      <form id="exercise-3-form">
        <!-- Question 1 -->
        <div class="question-container">
          <label for="question3-1"><i class="fas fa-question"></i> Question 1 (2 points)</label>
          <p><strong>Quelle est la principale mission du robot aspirateur ?</strong></p>
          <textarea id="question3-1" placeholder="Entrez votre réponse ici..."></textarea>
          <div id="feedback3-1" class="feedback"></div>
          <button type="button" class="btn-check" onclick="checkAnswer('question3-1', 'feedback3-1', 'La principale mission du robot aspirateur est de nettoyer les sols de manière autonome et efficace.', 2)">
            <i class="fas fa-check-circle"></i> Vérifier
          </button>
        </div>

        <!-- Question 2 -->
        <div class="question-container">
          <label for="question3-2"><i class="fas fa-question"></i> Question 2 (2 points)</label>
          <p><strong>Expliquez comment les capteurs contribuent au bon fonctionnement du robot aspirateur.</strong></p>
          <textarea id="question3-2" placeholder="Entrez votre réponse ici..."></textarea>
          <div id="feedback3-2" class="feedback"></div>
          <button type="button" class="btn-check" onclick="checkAnswer('question3-2', 'feedback3-2', 'Les capteurs contribuent au bon fonctionnement du robot aspirateur en détectant les obstacles, ce qui permet au robot d\'éviter les collisions et de naviguer de manière sécurisée.', 2)">
            <i class="fas fa-check-circle"></i> Vérifier
          </button>
        </div>

        <!-- Question 3 -->
        <div class="question-container">
          <label for="question3-3"><i class="fas fa-question"></i> Question 3 (3 points)</label>
          <p><strong>Précisez deux solutions techniques utilisées par le robot aspirateur pour éviter les collisions avec les objets.</strong></p>
          <textarea id="question3-3" placeholder="Entrez vos réponses ici..."></textarea>
          <div id="feedback3-3" class="feedback"></div>
          <button type="button" class="btn-check" onclick="checkAnswerMultipart('question3-3', 'feedback3-3', ['capteurs infrarouges', 'capteurs ultrasoniques', 'capteurs laser', 'détection d\'obstacles', 'mesure de distance'], 3)">
            <i class="fas fa-check-circle"></i> Vérifier
          </button>
        </div>
      </form>
    </section>

    <!-- Champ pour le mot magique -->
    <section class="access-section">
      <h3><i class="fas fa-key"></i> Accès aux Réponses Complètes</h3>
      <p>Pour accéder aux réponses complètes, entrez le mot magique donné par l'enseignant :</p>
      <input type="text" id="magic-word" placeholder="Entrez le mot magique ici...">
      <button type="button" onclick="unlockAnswers()">
        <i class="fas fa-unlock-alt"></i> Activer les réponses
      </button>
    </section>

    <!-- Bouton pour afficher les réponses -->
    <button id="show-answers-btn" class="hidden" type="button" onclick="displayAnswers()">
      <i class="fas fa-eye"></i> Afficher les réponses complètes
    </button>

    <!-- Réponses Correctes -->
    <div id="correct-answers" class="answers-section">
      <h3><i class="fas fa-check-double"></i> Réponses Correctes</h3>

      <div class="answer-card">
        <h4>Exercice 1 : Système de Sécurité Domestique Intelligent</h4>
        <ol>
          <li><strong>Question 1 :</strong> Le rôle principal des capteurs est de détecter des anomalies telles que des mouvements suspects ou des variations de température.</li>
          <li><strong>Question 2 :</strong> Le microprocesseur analyse les données des capteurs pour identifier des menaces potentielles et décider des actions à prendre.</li>
          <li><strong>Question 3 :</strong> En cas de détection d'une anomalie, le système active une alarme sonore et envoie une notification à l'utilisateur via une application mobile.</li>
        </ol>
      </div>

      <div class="answer-card">
        <h4>Exercice 2 : Système de Climatisation Autonome</h4>
        <ol>
          <li><strong>Question 1 :</strong> La principale mission du système de climatisation autonome est de réguler la température ambiante pour assurer le confort des occupants.</li>
          <li><strong>Question 2 :</strong> Les capteurs mesurent la température intérieure et extérieure pour fournir des données au microprocesseur.</li>
          <li><strong>Question 3 :</strong> Le microprocesseur analyse les données des capteurs et décide d'activer ou non le compresseur pour refroidir ou chauffer l'air ambiant jusqu'à atteindre la température souhaitée.</li>
        </ol>
      </div>

      <div class="answer-card">
        <h4>Exercice 3 : Robot Aspirateur</h4>
        <ol>
          <li><strong>Question 1 :</strong> La principale mission du robot aspirateur est de nettoyer les sols de manière autonome et efficace.</li>
          <li><strong>Question 2 :</strong> Les capteurs contribuent au bon fonctionnement du robot aspirateur en détectant les obstacles, ce qui permet au robot d'éviter les collisions et de naviguer de manière sécurisée.</li>
          <li><strong>Question 3 :</strong>
            <ul>
              <li>Solution 1 : Les capteurs infrarouges détectent les objets proches pour éviter les collisions.</li>
              <li>Solution 2 : Les capteurs ultrasoniques mesurent la distance jusqu'à un obstacle pour ajuster la trajectoire du robot.</li>
            </ul>
          </li>
        </ol>
      </div>
    </div>
  </main>

  <footer>
    <p>Exercices sur les systèmes techniques annéeexamencollège</p>
  </footer>

  <script>
    // Gestion du mode sombre
    const themeToggle = document.getElementById('themeToggle');
    const icon = themeToggle.querySelector('i');

    themeToggle.addEventListener('click', () => {
        document.body.classList.toggle('dark-theme');
        if (document.body.classList.contains('dark-theme')) {
            icon.classList.remove('fa-moon');
            icon.classList.add('fa-sun');
        } else {
            icon.classList.remove('fa-sun');
            icon.classList.add('fa-moon');
        }
    });

    // Suivi du score
    let userScore = 0;
    const totalPossibleScore = 21; // Total des points possibles dans tous les exercices

    // Fonction pour vérifier une réponse
    function checkAnswer(questionId, feedbackId, correctAnswer, points) {
      const userAnswer = document.getElementById(questionId).value.trim().toLowerCase();
      const feedbackElement = document.getElementById(feedbackId);
      
      // Vérifier si la réponse est correcte (vérification flexible avec mots-clés)
      const keywordsCorrect = correctAnswer.toLowerCase().split(' ');
      let isCorrect = false;
      
      // Une réponse est considérée correcte si elle contient au moins 70% des mots-clés importants
      const minKeywords = Math.ceil(keywordsCorrect.length * 0.6);
      let matchedKeywords = 0;
      
      for (const keyword of keywordsCorrect) {
        if (keyword.length > 3 && userAnswer.includes(keyword)) { // Ne compter que les mots de plus de 3 lettres
          matchedKeywords++;
        }
      }
      
      isCorrect = matchedKeywords >= minKeywords;
      
      // Afficher le feedback
      feedbackElement.style.display = 'block';
      if (isCorrect) {
        feedbackElement.className = 'feedback correct';
        feedbackElement.innerHTML = `<i class="fas fa-check-circle"></i> Correct ! Votre réponse contient les éléments essentiels. +${points} point${points > 1 ? 's' : ''}`;
        
        // Ajouter des points au score seulement si la question n'a pas déjà été répondue correctement
        if (!feedbackElement.dataset.scored) {
          userScore += points;
          feedbackElement.dataset.scored = "true";
          updateScore();
        }
      } else {
        feedbackElement.className = 'feedback incorrect';
        feedbackElement.innerHTML = `<i class="fas fa-times-circle"></i> Incorrect. Votre réponse ne contient pas suffisamment d'éléments clés.`;
      }
    }

    // Fonction pour vérifier une réponse avec plusieurs possibilités
    function checkAnswerMultipart(questionId, feedbackId, correctKeywords, points) {
      const userAnswer = document.getElementById(questionId).value.trim().toLowerCase();
      const feedbackElement = document.getElementById(feedbackId);
      
      // Vérifier si la réponse contient au moins 2 solutions techniques parmi les possibilités
      let matchedKeywords = 0;
      let matchedPhrases = [];
      
      for (const keyword of correctKeywords) {
        if (userAnswer.includes(keyword)) {
          matchedKeywords++;
          matchedPhrases.push(keyword);
        }
      }
      
      // La réponse est correcte si au moins 2 solutions sont mentionnées
      const isCorrect = matchedKeywords >= 2;
      
      // Afficher le feedback
      feedbackElement.style.display = 'block';
      if (isCorrect) {
        feedbackElement.className = 'feedback correct';
        feedbackElement.innerHTML = `<i class="fas fa-check-circle"></i> Correct ! Vous avez identifié ${matchedKeywords} solutions techniques valides. +${points} point${points > 1 ? 's' : ''}`;
        
        // Ajouter des points au score seulement si la question n'a pas déjà été répondue correctement
        if (!feedbackElement.dataset.scored) {
          userScore += points;
          feedbackElement.dataset.scored = "true";
          updateScore();
        }
      } else {
        feedbackElement.className = 'feedback incorrect';
        feedbackElement.innerHTML = `<i class="fas fa-times-circle"></i> Incorrect. Vous devez identifier au moins 2 solutions techniques valides.`;
      }
    }

    // Mettre à jour l'affichage du score
    function updateScore() {
      document.getElementById('currentScore').textContent = userScore;
      
      // Mettre à jour la barre de progression
      const progressPercentage = (userScore / totalPossibleScore) * 100;
      document.getElementById('progressBar').style.width = `${progressPercentage}%`;
      
      // Féliciter l'utilisateur s'il obtient tous les points
      if (userScore === totalPossibleScore) {
        alert('Félicitations ! Vous avez obtenu le score maximal. 🎉');
      }
    }

    // Fonction pour déverrouiller les réponses avec le mot magique
    function unlockAnswers() {
      const magicWord = document.getElementById('magic-word').value.trim();
      const showAnswersBtn = document.getElementById('show-answers-btn');

      if (magicWord === '2025dnbmontesoro') {
        showAnswersBtn.classList.remove('hidden'); // Affiche le bouton "Afficher les réponses"
        alert('Mot magique correct ! Vous pouvez maintenant afficher les réponses.');
      } else {
        alert('Mot magique incorrect. Veuillez demander à votre enseignant.');
      }
    }

    // Fonction pour afficher les réponses
    function displayAnswers() {
      const correctAnswers = document.getElementById('correct-answers');
      correctAnswers.style.display = 'block'; // Affiche les réponses correctes
    }

    // Initialiser le score au chargement de la page
    document.addEventListener('DOMContentLoaded', function() {
      updateScore();
    });
  </script>
</body>
</html>
